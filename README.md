# Mobile App Pentesting

1. Dynamic Analysis
2. Static Analysis

## Tools
- apktool - To decompile apps & make it readable.
- jadx - To view the content of apk file.
- MobSF - For Static & Dynamic analysis of an apk.
- Burpsuite - Proxy tool to intercept & modify requests.
- Android studio - IDE for app development & also for AVD.
- adb - To get shell and access the terminal of android.
- Frida - For Dynamic analysis and many more.
- Drozer - For dynamiic analysis and many other different stuffs.
- jassigner - To verify if the app is signed or not signed it.
- keytool - To generate for app to sign it.
- nexdump & dexdump - Convert byte code to hex format.
- objection - to use frida

  Android Penetration Testing NotesA comprehensive guide to Android application security testing, covering architecture, lab setup, static/dynamic analysis, and exploitation techniques.ðŸ“š Table of ContentsLab Setup & EnvironmentAndroid Architecture FundamentalsStatic Analysis (Reversing)Dynamic AnalysisNetwork Traffic AnalysisData Storage & SecurityCommon VulnerabilitiesTools Cheatsheet1. Lab Setup & EnvironmentEssential ComponentsAndroid Studio: The primary IDE. Used for creating virtual devices (AVDs) and accessing the SDK tools.Android Virtual Device (AVD):Architecture: Use x86 or x86_64 images for speed on PC. ARM images are slow but may be necessary for apps with native ARM libraries.Google APIs: Choose an image without "Google Play" if you want easy root access (Play Store images are often production-signed and harder to root).Rooting:Definition: Gaining administrative privileges (UID 0) to bypass sandbox limitations.Mechanism: Usually involves installing the su binary to /system/xbin/ or /system/bin/.Tools: SuperSU, Magisk (modern standard).ADB (Android Debug Bridge)The bridge between your host machine and the Android device.Connect: adb connect <ip>:<port>Shell Access: adb shellRoot Access: adb root (if supported by the ROM) or adb shell then su.2. Android Architecture FundamentalsThe Android Security ModelUID Isolation: Each app runs as a distinct Linux user with a unique User ID (UID). By default, files created by one app cannot be read by another.The Sandbox: Apps run in their own Virtual Machine (Dalvik or ART), isolated from the system and other apps.The Android Manifest (AndroidManifest.xml)The control center of the app. It defines:Package Name: Unique identifier (e.g., com.example.bank).Permissions: Requests for sensitive data (e.g., <uses-permission android:name="android.permission.INTERNET" />).Application Components:Activities: UI screens (entry points).Services: Background tasks (no UI).Broadcast Receivers: Listeners for system-wide events (e.g., "SMS Received").Content Providers: Database-like interfaces for sharing data between apps.Exported ComponentsRisk: If a component has android:exported="true", it can be launched by any other app on the device.Implicit Export: If a component contains an <intent-filter>, it is exported by default (on older Android versions) unless explicitly set to false.3. Static Analysis (Reversing)Analyzing the application source code without running it.Decompiling & ReversingAPK Structure: It is a ZIP file. Rename .apk to .zip to see assets, resources, and classes.dex.Classes.dex: Contains the Dalvik Bytecode (the logic).Smali: The human-readable assembly language of Android.Tool: APKTool allows modification of code and repacking.Java Code:Tool: dex2jar converts .dex to .jar.Tool: JD-GUI or Jadx allows viewing the .jar as Java source.Analysis ChecklistManifest Analysis:Look for android:debuggable="true" (allows debugger attachment).Look for android:allowBackup="true" (allows data extraction via adb backup).Identify exported Activities/Services.Hardcoded Secrets:Search strings.xml and source code for API Keys, credentials, or encryption keys.Code Obfuscation:Check if ProGuard/R8 was used (classes named a.b.c).SQL Injection:Look for raw SQL queries using string concatenation instead of parameterized arguments (common in Content Providers).4. Dynamic AnalysisTesting the application while it is running.Debugging & LoggingLogcat: Developers often leave sensitive info in logs.adb logcat | grep "com.target.app"Look for tokens, PII, or debug logic flow.Method Tracing:Frida: Hook methods to see inputs/outputs in real-time.Objection: "Frida for non-programmers." Allows exploring the heap and filesystem at runtime.DrozerA framework for Android security assessment.Connect: adb forward tcp:31415 tcp:31415 -> drozer console connect.Attack Surface: run app.package.attacksurface com.target.app.Exploit Content Providers: run app.provider.query content://com.target.provider/path.Start Activities: run app.activity.start --component com.target.app com.target.app.HiddenActivity.5. Network Traffic AnalysisIntercepting and manipulating backend communication.SetupBurp Suite: Set proxy listener to All Interfaces on port 8080.Android Proxy: Settings -> Wi-Fi -> Modify Network -> Proxy (Manual) -> Host IP & Port.CA Certificate:Export CA from Burp (cacert.der).Rename to .cer and push to device.Install via Security Settings ("Install from SD Card").Note: On Android 7.0+, user certificates are not trusted by apps by default. You may need to move the cert to the System Store (requires root).Certificate PinningConcept: App checks if the server's certificate matches a known hash inside the app.Bypass:Frida/Objection: android sslpinning disable.Xposed Framework: SSLUnpinning modules.Patching: Modifying Smali code to return true during certificate checks.6. Data Storage & SecurityStorage LocationsInternal Storage (/data/data/<package>/):Private by default.Contains: shared_prefs, databases, cache.External Storage (/sdcard/):Vulnerable: World-readable (if using legacy permissions) or accessible by user. Never store sensitive data here.Shared Preferences:XML files for settings. often contain unencrypted session tokens (e.g., user_pref.xml).Databases:SQLite files (.db). Check if passwords are stored in plain text.7. Common VulnerabilitiesTapjacking:Overlaying a transparent malicious activity over a legitimate one to trick users into clicking buttons.Check: Does the app implement android:filterTouchesWhenObscured="true"?Intent Injection:Passing a malicious Intent to an exported component that proxies it to a protected component (e.g., accessing a private File Provider).Deep Link Vulnerabilities:Links (myapp://) that execute actions without validation (e.g., CSRF via deep link).8. Tools CheatsheetToolUsageCommand ExampleADBBridge to deviceadb devices, adb shellAPKToolDecompile Resourcesapktool d app.apkAPKToolRecompile/Buildapktool b app_folder -o new.apkJadxDecompile to Javajadx-gui app.apkDex2jarDex -> Jard2j-dex2jar.sh classes.dexKeytoolGenerate Keyskeytool -genkey -v -keystore my.keystoreJarsignerSign APKsjarsigner -keystore my.keystore app.apk aliasDrozerComponent Fuzzingdrozer console connectFridaDynamic Hookingfrida -U -f com.package -l script.jsObjectionRuntime Explorationobjection -g com.package exploreMobSFAutomated AnalysisRun via Docker/Localhost
